<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<title>NExcel</title>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
		<meta name="author" value="Stefano Franco">
		<meta name="keywords" content=".net, C#, VB.NET, Office, Excel, spreadsheet, framework, API, NExcel">
		<link href="../css/style.css" rel="stylesheet" type="text/css"></head>
	<body bgcolor="#ffffff" link="#525d76" text="#000000">
		<table border="0" cellspacing="0" width="100%">
			<tbody>
				<tr>
					<td colspan="2">
						<img src="../img/logo.gif" align="left" border="0">
					</td>
				</tr>
			</tbody></table>
		<table id="main" border="0" cellpadding="0" cellspacing="2" width="100%">
			<tbody>
				<tr>
					<td colspan="2">
						<hr noshade size="1">
					</td>
				</tr>
				<tr>
					<td id="navbar" align="left" valign="top" width="1">
						<table id="navbar" border="0" cellpadding="0" cellspacing="0">
							<tbody>
								<tr>
									<td class="navbarHeader" nowrap>
										<strong>NExcel</strong>&nbsp;
									</td>
								</tr>
								<tr>
									<td class="navbarItem"><small> <A class="navbarHref" href="../index.html#intro">Introduction</a>&nbsp;
										</small>
									</td>
								</tr>
								<TR>
									<TD class="navbarItem"><SMALL><A class="navbarHref" href="../index.html#features">Features</A></SMALL></TD>
								</TR>
								<TR>
									<TD class="navbarItem"><SMALL><A class="navbarHref" href="../index.html#requirements">Requirements</A></SMALL></TD>
								</TR>
								<TR>
									<TD class="navbarItem"><SMALL><A class="navbarHref" href="../index.html#installation">Installation</A></SMALL></TD>
								</TR>
								<tr>
									<td class="navbarHeader" nowrap>
										<strong>NExcel Documentation</strong>
									</td>
								</tr>
								<tr>
									<td class="navbarItem"><small> <a class="navbarHref" href="../documentation/getting-started.html">Getting Started</a>&nbsp;&nbsp; </small>
									</td>
								</tr>
								<tr>
									<td class="navbarItem"><small> <a class="navbarHref" href="../documentation/samples.html">Samples</a>&nbsp;
										</small>
									</td>
								</tr>
								<tr>
									<td class="navbarItem"><small> <a class="navbarHref" href="../documentation/reference/index.html">API Reference</a>&nbsp; </small>
									</td>
								</tr>
								<tr>
									<td class="navbarHeader" nowrap>
										<strong>NExcel Project</strong>&nbsp;
									</td>
								</tr>
								<tr>
									<td class="navbarItem"><small> <a class="navbarHref" href="../project/license.html#license">License</a>&nbsp; </small>
									</td>
								</tr>
								<tr>
									<td class="navbarItem"><small> <a class="navbarHref" href="../project/license.html#about">About</a>&nbsp; </small>
									</td>
								</tr>
								<tr>
									<td class="navbarItem"><small> <a class="navbarHref" href="../project/license.html#contactus">Contact us</a>&nbsp;&nbsp; </small>
									</td>
								</tr>
								<tr>
									<td class="navbarHeader" nowrap>
										<strong>NExcel Releases</strong>&nbsp;
									</td>
								</tr>
								<tr>
									<td class="navbarItem"><small> <a class="navbarHref" href="http://www.sourceforge.net/projects/nexcel">Download</a> </small>
									</td>
								</tr>
							</tbody></table>
					</td>
					<td id="mainContents" align="left" valign="top" width="*">
					<h1>Getting Started</h1>
<p class="i1">
In this page you'll find some brief tutorials to get started with NExcel.
<BR>They are simple examples that explain how reading Excel files using C# and NExcel.
</p>
<p class="i1">
Here is a list of the tutorials.
</p>
<p class="i1">
  <ul>
  <li class="ist1"><a href="#gscontents">Reading Contents from a Excel file</a></li>
  <li class="ist1"><a href="#gsvalues">Reading Values from a Excel file</a></li>
  </ul>
</p>
<p class="i1">
<B>Reading Contents from a Excel file</B> is a "Hello World" example, useful if you are new 
to NExcel. 
<BR>It writes to console all the cell contents in a Excel file.
</p>
<p class="i1">
<B>Reading Values from a Excel file</B> does the same, but with values. 
<BR>Instead of contents, it writes to console all the inner values of cells.
</p>
<BR>
<a name="gscontents"></a>
<h2>Reading Contents from a Excel file</h2>
<p class="i1">
This example explains how you can read cell contents of a Excel file using C# and NExcel.
<BR>At the end of this you will be able to open a Excel file, open all of its sheets 
and for each sheet read the cell contents. 
<BR>The full code of this example is also available in <a href="./samples.html">ExcelContents</a> sample.
</p>
<p class="i1">
Cell content is the layout text a user can see in a cell using Ms Office Excel. It usually differs from inner value of cells.
For instance, consider a number cell with 2 digits and set to value 6534.1234. 
The cell will contain inner value 6534.1234 and will show the content "6534.12". 
</p>
<p class="i1">
In NExcel you get the cell contents using property <font class="code">Cell.Contents</font>.
This property returns a <font class="code">string</font>. If cell is empty, it returns "".
</p>
<p class="i1">
Now let's see how using <font class="code">Cell.Contents</font> in our code. 
<BR>At first step, add the <font class="code">using</font> statement for NExcel at the top of your code.
</p>
<pre class="codetext">
using NExcel;
</pre>
<p class="i1">
Open the Excel file with name <font class="code">filename</font> using method <font class="code">Workbook.getWorkbook()</font>
and assign the result to <font class="code">workbook</font>. 
Get each sheet from <font class="code">workbook.Sheets</font> and assign it to <font class="code">sheet</font>.
</p>
<pre class="codetext">
// open the Excel workbook
Workbook workbook = Workbook.getWorkbook(filename);

// for each sheet in workbook, write cell contents to console
foreach (Sheet sheet in workbook.Sheets)
{
  ......
</pre>
<p class="i1">
Get all cells in <font class="code">sheet</font>, iterating for each row and column.
</p>
<pre class="codetext">
// for each row
for (int irow = 0; irow < sheet.Rows; irow++)
{
    // for each column
    for(int icol=0; icol < sheet.Columns; icol++)
    {
        // get current cell
        Cell cell = sheet.getCell(icol, irow);
        .....
</pre>
<p class="i1">
Now, get contents of <font class="code">cell</font> using property <font class="code">Cell.Contents</font> and write the result to console.
<BR><font class="code">Cell.Contents</font> returns the cell content as a string. If cell is empty, it returns "".
</p>
<pre class="codetext">
        // write to console the cell contents
        System.Console.WriteLine("{0}[{1},{2}]:  {3}", sheet.Name, irow, icol, cell.Contents);
</pre>
<p class="i1">
At the end, close the workbook with <font class="code">workbook.close()</font>.
</p>
<pre class="codetext">
workbook.close();
</pre>
<BR>
<a name="gsvalues"></a>
<h2>Reading Values from a Excel file</h2>
<p class="i1">
This example explains how read cell values of a Excel file using C# and NExcel.
<BR>At the end of this you will be able to open a Excel file, open all of its sheets 
and for each sheet read all cell values. 
<BR>The full code of this example is also available in <a href="./samples.html">ExcelValues</a> sample.
</p>
<p class="i1">
Cell value is the inner data of a cell. 
Cell value is more reliable than contents, because it doesn't depend on cell format. 
</p>
<p class="i1">
In NExcel you get the cell value using property <font class="code">Cell.Value</font>. 
This property returns a object, which can be a <font class="code">double</font> for numeric cells, 
a <font class="code">DateTime</font> for date cells, a <font class="code">string</font> for text cells and so on for other cells.
</p>
<p class="i1">
Now let's see how using <font class="code">Cell.Value</font> in our code. 
<BR>Open the Excel file, get the sheets and retrieve all cells of the sheet. 
The steps to follow are the same as in <a href="#gscontents">Reading Contents from a Excel file</a>. 
You have now defined a <font class="code">workbook</font>, 
a <font class="code">sheet</font> and a <font class="code">cell</font>.
</p>
<p class="i1">
Now get the cell value with <font class="code">Cell.Value</font> and write it to console. 
If it is null is changed to "".
</p>
<pre class="codetext">
    // get value as string
    string strValue =  (cell.Value!=null)  ? cell.Value.ToString() : "";

    // write to console the cell value 
    System.Console.WriteLine("{0}[{1},{2}]: {3}", sheet.Name, irow, icol, strValue);
</pre>
</p>
<p class="i1">
You'll see that cells of different type return values of different type.
Number cells return a <font class="code">double</font>, 
date cells and time cells a <font class="code">DateTime</font> object,
text cells a <font class="code">string</font> and empty cells a <font class="code">null</font>.
</p>
<BR>
<P>&nbsp;</P>

					</td>
				</tr>
				<tr>
					<td colspan="2">
						<hr noshade size="1">
					</td>
				</tr>
				<tr>
					<td colspan="2">
						<div align="center"><font color="#525d76" size="-1"><em>Copyright &#169; 2005  Stefano Franco</em></font>
						</div>
					</td>
				</tr>
			</tbody></table>
	</body>
</html>



